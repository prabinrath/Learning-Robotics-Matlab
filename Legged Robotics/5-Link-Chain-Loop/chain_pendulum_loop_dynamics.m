function qd = chain_pendulum_loop_dynamics(q)
th1 = q(1); th2 = q(2); th3 = q(3); th4 = q(4); th5 = q(5);
th1d = q(6); th2d = q(7); th3d = q(8); th4d = q(9); th5d = q(10);
U = [(75*cos(th2 + th3 + th4))/2 + (25*cos(th3 + th4 + th5))/2 + (25*cos(th2 + th3 + th4 + th5))/2 + (125*cos(th2 + th3))/2 + (75*cos(th3 + th4))/2 + (25*cos(th4 + th5))/2 + (175*cos(th2))/2 + (125*cos(th3))/2 + (75*cos(th4))/2 + (25*cos(th5))/2 + 875/6, (75*cos(th2 + th3 + th4))/4 + (25*cos(th3 + th4 + th5))/2 + (25*cos(th2 + th3 + th4 + th5))/4 + (125*cos(th2 + th3))/4 + (75*cos(th3 + th4))/2 + (25*cos(th4 + th5))/2 + (175*cos(th2))/4 + (125*cos(th3))/2 + (75*cos(th4))/2 + (25*cos(th5))/2 + 275/3, (75*cos(th2 + th3 + th4))/4 + (25*cos(th3 + th4 + th5))/4 + (25*cos(th2 + th3 + th4 + th5))/4 + (125*cos(th2 + th3))/4 + (75*cos(th3 + th4))/4 + (25*cos(th4 + th5))/2 + (125*cos(th3))/4 + (75*cos(th4))/2 + (25*cos(th5))/2 + 50, (75*cos(th2 + th3 + th4))/4 + (25*cos(th3 + th4 + th5))/4 + (25*cos(th2 + th3 + th4 + th5))/4 + (75*cos(th3 + th4))/4 + (25*cos(th4 + th5))/4 + (75*cos(th4))/4 + (25*cos(th5))/2 + 125/6, (25*cos(th3 + th4 + th5))/4 + (25*cos(th2 + th3 + th4 + th5))/4 + (25*cos(th4 + th5))/4 + (25*cos(th5))/4 + 25/6, - 5*cos(th1 + th2 + th3 + th4 + th5) - 5*cos(th1 + th2 + th3) - 5*cos(th1 + th2 + th3 + th4) - 5*cos(th1 + th2) - 5*cos(th1), - 5*sin(th1 + th2 + th3 + th4 + th5) - 5*sin(th1 + th2 + th3) - 5*sin(th1 + th2 + th3 + th4) - 5*sin(th1 + th2) - 5*sin(th1); (75*cos(th2 + th3 + th4))/4 + (25*cos(th3 + th4 + th5))/2 + (25*cos(th2 + th3 + th4 + th5))/4 + (125*cos(th2 + th3))/4 + (75*cos(th3 + th4))/2 + (25*cos(th4 + th5))/2 + (175*cos(th2))/4 + (125*cos(th3))/2 + (75*cos(th4))/2 + (25*cos(th5))/2 + 275/3, (25*cos(th3 + th4 + th5))/2 + (75*cos(th3 + th4))/2 + (25*cos(th4 + th5))/2 + (125*cos(th3))/2 + (75*cos(th4))/2 + (25*cos(th5))/2 + 275/3, (25*cos(th3 + th4 + th5))/4 + (75*cos(th3 + th4))/4 + (25*cos(th4 + th5))/2 + (125*cos(th3))/4 + (75*cos(th4))/2 + (25*cos(th5))/2 + 50, (25*cos(th3 + th4 + th5))/4 + (75*cos(th3 + th4))/4 + (25*cos(th4 + th5))/4 + (75*cos(th4))/4 + (25*cos(th5))/2 + 125/6, (25*cos(th3 + th4 + th5))/4 + (25*cos(th4 + th5))/4 + (25*cos(th5))/4 + 25/6, - 5*cos(th1 + th2 + th3 + th4 + th5) - 5*cos(th1 + th2 + th3) - 5*cos(th1 + th2 + th3 + th4) - 5*cos(th1 + th2), - 5*sin(th1 + th2 + th3 + th4 + th5) - 5*sin(th1 + th2 + th3) - 5*sin(th1 + th2 + th3 + th4) - 5*sin(th1 + th2); (75*cos(th2 + th3 + th4))/4 + (25*cos(th3 + th4 + th5))/4 + (25*cos(th2 + th3 + th4 + th5))/4 + (125*cos(th2 + th3))/4 + (75*cos(th3 + th4))/4 + (25*cos(th4 + th5))/2 + (125*cos(th3))/4 + (75*cos(th4))/2 + (25*cos(th5))/2 + 50, (25*cos(th3 + th4 + th5))/4 + (75*cos(th3 + th4))/4 + (25*cos(th4 + th5))/2 + (125*cos(th3))/4 + (75*cos(th4))/2 + (25*cos(th5))/2 + 50, (25*cos(th4 + th5))/2 + (75*cos(th4))/2 + (25*cos(th5))/2 + 50, (25*cos(th4 + th5))/4 + (75*cos(th4))/4 + (25*cos(th5))/2 + 125/6, (25*cos(th4 + th5))/4 + (25*cos(th5))/4 + 25/6, - 5*cos(th1 + th2 + th3 + th4 + th5) - 5*cos(th1 + th2 + th3) - 5*cos(th1 + th2 + th3 + th4), - 5*sin(th1 + th2 + th3 + th4 + th5) - 5*sin(th1 + th2 + th3) - 5*sin(th1 + th2 + th3 + th4); (75*cos(th2 + th3 + th4))/4 + (25*cos(th3 + th4 + th5))/4 + (25*cos(th2 + th3 + th4 + th5))/4 + (75*cos(th3 + th4))/4 + (25*cos(th4 + th5))/4 + (75*cos(th4))/4 + (25*cos(th5))/2 + 125/6, (25*cos(th3 + th4 + th5))/4 + (75*cos(th3 + th4))/4 + (25*cos(th4 + th5))/4 + (75*cos(th4))/4 + (25*cos(th5))/2 + 125/6, (25*cos(th4 + th5))/4 + (75*cos(th4))/4 + (25*cos(th5))/2 + 125/6, (25*cos(th5))/2 + 125/6, (25*cos(th5))/4 + 25/6, - 5*cos(th1 + th2 + th3 + th4 + th5) - 5*cos(th1 + th2 + th3 + th4), - 5*sin(th1 + th2 + th3 + th4 + th5) - 5*sin(th1 + th2 + th3 + th4); (25*cos(th3 + th4 + th5))/4 + (25*cos(th2 + th3 + th4 + th5))/4 + (25*cos(th4 + th5))/4 + (25*cos(th5))/4 + 25/6, (25*cos(th3 + th4 + th5))/4 + (25*cos(th4 + th5))/4 + (25*cos(th5))/4 + 25/6, (25*cos(th4 + th5))/4 + (25*cos(th5))/4 + 25/6, (25*cos(th5))/4 + 25/6, 25/6, -5*cos(th1 + th2 + th3 + th4 + th5), -5*sin(th1 + th2 + th3 + th4 + th5); 5*cos(th1 + th2 + th3 + th4 + th5) + 5*cos(th1 + th2 + th3) + 5*cos(th1 + th2 + th3 + th4) + 5*cos(th1 + th2) + 5*cos(th1), 5*cos(th1 + th2 + th3 + th4 + th5) + 5*cos(th1 + th2 + th3) + 5*cos(th1 + th2 + th3 + th4) + 5*cos(th1 + th2), 5*cos(th1 + th2 + th3 + th4 + th5) + 5*cos(th1 + th2 + th3) + 5*cos(th1 + th2 + th3 + th4), 5*cos(th1 + th2 + th3 + th4 + th5) + 5*cos(th1 + th2 + th3 + th4), 5*cos(th1 + th2 + th3 + th4 + th5), 0, 0; 5*sin(th1 + th2 + th3 + th4 + th5) + 5*sin(th1 + th2 + th3) + 5*sin(th1 + th2 + th3 + th4) + 5*sin(th1 + th2) + 5*sin(th1), 5*sin(th1 + th2 + th3 + th4 + th5) + 5*sin(th1 + th2 + th3) + 5*sin(th1 + th2 + th3 + th4) + 5*sin(th1 + th2), 5*sin(th1 + th2 + th3 + th4 + th5) + 5*sin(th1 + th2 + th3) + 5*sin(th1 + th2 + th3 + th4), 5*sin(th1 + th2 + th3 + th4 + th5) + 5*sin(th1 + th2 + th3 + th4), 5*sin(th1 + th2 + th3 + th4 + th5), 0, 0];
W = [(175*th2d^2*sin(th2))/4 - (981*sin(th1 + th2 + th3))/16 - (2943*sin(th1 + th2 + th3 + th4))/80 - (6867*sin(th1 + th2))/80 - (8829*sin(th1))/80 - (981*sin(th1 + th2 + th3 + th4 + th5))/80 + (125*th3d^2*sin(th3))/4 + (75*th4d^2*sin(th4))/4 + (25*th5d^2*sin(th5))/4 + (75*th2d^2*sin(th2 + th3 + th4))/4 + (75*th3d^2*sin(th2 + th3 + th4))/4 + (75*th4d^2*sin(th2 + th3 + th4))/4 + (25*th3d^2*sin(th3 + th4 + th5))/4 + (25*th4d^2*sin(th3 + th4 + th5))/4 + (25*th5d^2*sin(th3 + th4 + th5))/4 + (25*th2d^2*sin(th2 + th3 + th4 + th5))/4 + (25*th3d^2*sin(th2 + th3 + th4 + th5))/4 + (25*th4d^2*sin(th2 + th3 + th4 + th5))/4 + (25*th5d^2*sin(th2 + th3 + th4 + th5))/4 + (125*th2d^2*sin(th2 + th3))/4 + (125*th3d^2*sin(th2 + th3))/4 + (75*th3d^2*sin(th3 + th4))/4 + (75*th4d^2*sin(th3 + th4))/4 + (25*th4d^2*sin(th4 + th5))/4 + (25*th5d^2*sin(th4 + th5))/4 + (125*th1d*th2d*sin(th2 + th3))/2 + (125*th1d*th3d*sin(th2 + th3))/2 + (125*th2d*th3d*sin(th2 + th3))/2 + (75*th1d*th3d*sin(th3 + th4))/2 + (75*th1d*th4d*sin(th3 + th4))/2 + (75*th2d*th3d*sin(th3 + th4))/2 + (75*th2d*th4d*sin(th3 + th4))/2 + (25*th1d*th4d*sin(th4 + th5))/2 + (75*th3d*th4d*sin(th3 + th4))/2 + (25*th1d*th5d*sin(th4 + th5))/2 + (25*th2d*th4d*sin(th4 + th5))/2 + (25*th2d*th5d*sin(th4 + th5))/2 + (25*th3d*th4d*sin(th4 + th5))/2 + (25*th3d*th5d*sin(th4 + th5))/2 + (25*th4d*th5d*sin(th4 + th5))/2 + (175*th1d*th2d*sin(th2))/2 + (125*th1d*th3d*sin(th3))/2 + (125*th2d*th3d*sin(th3))/2 + (75*th1d*th4d*sin(th4))/2 + (75*th2d*th4d*sin(th4))/2 + (25*th1d*th5d*sin(th5))/2 + (75*th3d*th4d*sin(th4))/2 + (25*th2d*th5d*sin(th5))/2 + (25*th3d*th5d*sin(th5))/2 + (25*th4d*th5d*sin(th5))/2 + (75*th1d*th2d*sin(th2 + th3 + th4))/2 + (75*th1d*th3d*sin(th2 + th3 + th4))/2 + (75*th1d*th4d*sin(th2 + th3 + th4))/2 + (75*th2d*th3d*sin(th2 + th3 + th4))/2 + (75*th2d*th4d*sin(th2 + th3 + th4))/2 + (25*th1d*th3d*sin(th3 + th4 + th5))/2 + (75*th3d*th4d*sin(th2 + th3 + th4))/2 + (25*th1d*th4d*sin(th3 + th4 + th5))/2 + (25*th2d*th3d*sin(th3 + th4 + th5))/2 + (25*th1d*th5d*sin(th3 + th4 + th5))/2 + (25*th2d*th4d*sin(th3 + th4 + th5))/2 + (25*th2d*th5d*sin(th3 + th4 + th5))/2 + (25*th3d*th4d*sin(th3 + th4 + th5))/2 + (25*th3d*th5d*sin(th3 + th4 + th5))/2 + (25*th4d*th5d*sin(th3 + th4 + th5))/2 + (25*th1d*th2d*sin(th2 + th3 + th4 + th5))/2 + (25*th1d*th3d*sin(th2 + th3 + th4 + th5))/2 + (25*th1d*th4d*sin(th2 + th3 + th4 + th5))/2 + (25*th2d*th3d*sin(th2 + th3 + th4 + th5))/2 + (25*th1d*th5d*sin(th2 + th3 + th4 + th5))/2 + (25*th2d*th4d*sin(th2 + th3 + th4 + th5))/2 + (25*th2d*th5d*sin(th2 + th3 + th4 + th5))/2 + (25*th3d*th4d*sin(th2 + th3 + th4 + th5))/2 + (25*th3d*th5d*sin(th2 + th3 + th4 + th5))/2 + (25*th4d*th5d*sin(th2 + th3 + th4 + th5))/2; (125*th3d^2*sin(th3))/4 - (981*sin(th1 + th2 + th3))/16 - (2943*sin(th1 + th2 + th3 + th4))/80 - (6867*sin(th1 + th2))/80 - (175*th1d^2*sin(th2))/4 - (981*sin(th1 + th2 + th3 + th4 + th5))/80 + (75*th4d^2*sin(th4))/4 + (25*th5d^2*sin(th5))/4 - (75*th1d^2*sin(th2 + th3 + th4))/4 + (25*th3d^2*sin(th3 + th4 + th5))/4 + (25*th4d^2*sin(th3 + th4 + th5))/4 + (25*th5d^2*sin(th3 + th4 + th5))/4 - (25*th1d^2*sin(th2 + th3 + th4 + th5))/4 - (125*th1d^2*sin(th2 + th3))/4 + (75*th3d^2*sin(th3 + th4))/4 + (75*th4d^2*sin(th3 + th4))/4 + (25*th4d^2*sin(th4 + th5))/4 + (25*th5d^2*sin(th4 + th5))/4 + (75*th1d*th3d*sin(th3 + th4))/2 + (75*th1d*th4d*sin(th3 + th4))/2 + (75*th2d*th3d*sin(th3 + th4))/2 + (75*th2d*th4d*sin(th3 + th4))/2 + (25*th1d*th4d*sin(th4 + th5))/2 + (75*th3d*th4d*sin(th3 + th4))/2 + (25*th1d*th5d*sin(th4 + th5))/2 + (25*th2d*th4d*sin(th4 + th5))/2 + (25*th2d*th5d*sin(th4 + th5))/2 + (25*th3d*th4d*sin(th4 + th5))/2 + (25*th3d*th5d*sin(th4 + th5))/2 + (25*th4d*th5d*sin(th4 + th5))/2 + (125*th1d*th3d*sin(th3))/2 + (125*th2d*th3d*sin(th3))/2 + (75*th1d*th4d*sin(th4))/2 + (75*th2d*th4d*sin(th4))/2 + (25*th1d*th5d*sin(th5))/2 + (75*th3d*th4d*sin(th4))/2 + (25*th2d*th5d*sin(th5))/2 + (25*th3d*th5d*sin(th5))/2 + (25*th4d*th5d*sin(th5))/2 + (25*th1d*th3d*sin(th3 + th4 + th5))/2 + (25*th1d*th4d*sin(th3 + th4 + th5))/2 + (25*th2d*th3d*sin(th3 + th4 + th5))/2 + (25*th1d*th5d*sin(th3 + th4 + th5))/2 + (25*th2d*th4d*sin(th3 + th4 + th5))/2 + (25*th2d*th5d*sin(th3 + th4 + th5))/2 + (25*th3d*th4d*sin(th3 + th4 + th5))/2 + (25*th3d*th5d*sin(th3 + th4 + th5))/2 + (25*th4d*th5d*sin(th3 + th4 + th5))/2; (75*th4d^2*sin(th4))/4 - (981*sin(th1 + th2 + th3))/16 - (2943*sin(th1 + th2 + th3 + th4))/80 - (125*th1d^2*sin(th3))/4 - (125*th2d^2*sin(th3))/4 - (981*sin(th1 + th2 + th3 + th4 + th5))/80 + (25*th5d^2*sin(th5))/4 - (75*th1d^2*sin(th2 + th3 + th4))/4 - (25*th1d^2*sin(th3 + th4 + th5))/4 - (25*th2d^2*sin(th3 + th4 + th5))/4 - (25*th1d^2*sin(th2 + th3 + th4 + th5))/4 - (125*th1d^2*sin(th2 + th3))/4 - (75*th1d^2*sin(th3 + th4))/4 - (75*th2d^2*sin(th3 + th4))/4 + (25*th4d^2*sin(th4 + th5))/4 + (25*th5d^2*sin(th4 + th5))/4 - (75*th1d*th2d*sin(th3 + th4))/2 + (25*th1d*th4d*sin(th4 + th5))/2 + (25*th1d*th5d*sin(th4 + th5))/2 + (25*th2d*th4d*sin(th4 + th5))/2 + (25*th2d*th5d*sin(th4 + th5))/2 + (25*th3d*th4d*sin(th4 + th5))/2 + (25*th3d*th5d*sin(th4 + th5))/2 + (25*th4d*th5d*sin(th4 + th5))/2 - (125*th1d*th2d*sin(th3))/2 + (75*th1d*th4d*sin(th4))/2 + (75*th2d*th4d*sin(th4))/2 + (25*th1d*th5d*sin(th5))/2 + (75*th3d*th4d*sin(th4))/2 + (25*th2d*th5d*sin(th5))/2 + (25*th3d*th5d*sin(th5))/2 + (25*th4d*th5d*sin(th5))/2 - (25*th1d*th2d*sin(th3 + th4 + th5))/2; (25*th5d^2*sin(th5))/4 - (2943*sin(th1 + th2 + th3 + th4))/80 - (75*th1d^2*sin(th4))/4 - (75*th2d^2*sin(th4))/4 - (75*th3d^2*sin(th4))/4 - (981*sin(th1 + th2 + th3 + th4 + th5))/80 - (75*th1d^2*sin(th2 + th3 + th4))/4 - (25*th1d^2*sin(th3 + th4 + th5))/4 - (25*th2d^2*sin(th3 + th4 + th5))/4 - (25*th1d^2*sin(th2 + th3 + th4 + th5))/4 - (75*th1d^2*sin(th3 + th4))/4 - (75*th2d^2*sin(th3 + th4))/4 - (25*th1d^2*sin(th4 + th5))/4 - (25*th2d^2*sin(th4 + th5))/4 - (25*th3d^2*sin(th4 + th5))/4 - (75*th1d*th2d*sin(th3 + th4))/2 - (25*th1d*th2d*sin(th4 + th5))/2 - (25*th1d*th3d*sin(th4 + th5))/2 - (25*th2d*th3d*sin(th4 + th5))/2 - (75*th1d*th2d*sin(th4))/2 - (75*th1d*th3d*sin(th4))/2 - (75*th2d*th3d*sin(th4))/2 + (25*th1d*th5d*sin(th5))/2 + (25*th2d*th5d*sin(th5))/2 + (25*th3d*th5d*sin(th5))/2 + (25*th4d*th5d*sin(th5))/2 - (25*th1d*th2d*sin(th3 + th4 + th5))/2; - (981*sin(th1 + th2 + th3 + th4 + th5))/80 - (25*th1d^2*sin(th5))/4 - (25*th2d^2*sin(th5))/4 - (25*th3d^2*sin(th5))/4 - (25*th4d^2*sin(th5))/4 - (25*th1d^2*sin(th3 + th4 + th5))/4 - (25*th2d^2*sin(th3 + th4 + th5))/4 - (25*th1d^2*sin(th2 + th3 + th4 + th5))/4 - (25*th1d^2*sin(th4 + th5))/4 - (25*th2d^2*sin(th4 + th5))/4 - (25*th3d^2*sin(th4 + th5))/4 - (25*th1d*th2d*sin(th4 + th5))/2 - (25*th1d*th3d*sin(th4 + th5))/2 - (25*th2d*th3d*sin(th4 + th5))/2 - (25*th1d*th2d*sin(th5))/2 - (25*th1d*th3d*sin(th5))/2 - (25*th1d*th4d*sin(th5))/2 - (25*th2d*th3d*sin(th5))/2 - (25*th2d*th4d*sin(th5))/2 - (25*th3d*th4d*sin(th5))/2 - (25*th1d*th2d*sin(th3 + th4 + th5))/2; 5*th1d^2*sin(th1) + 5*th1d^2*sin(th1 + th2 + th3 + th4 + th5) + 5*th2d^2*sin(th1 + th2 + th3 + th4 + th5) + 5*th3d^2*sin(th1 + th2 + th3 + th4 + th5) + 5*th4d^2*sin(th1 + th2 + th3 + th4 + th5) + 5*th5d^2*sin(th1 + th2 + th3 + th4 + th5) + 5*th1d^2*sin(th1 + th2 + th3) + 5*th2d^2*sin(th1 + th2 + th3) + 5*th3d^2*sin(th1 + th2 + th3) + 5*th1d^2*sin(th1 + th2 + th3 + th4) + 5*th2d^2*sin(th1 + th2 + th3 + th4) + 5*th3d^2*sin(th1 + th2 + th3 + th4) + 5*th4d^2*sin(th1 + th2 + th3 + th4) + 5*th1d^2*sin(th1 + th2) + 5*th2d^2*sin(th1 + th2) + 10*th1d*th2d*sin(th1 + th2) + 10*th1d*th2d*sin(th1 + th2 + th3 + th4 + th5) + 10*th1d*th3d*sin(th1 + th2 + th3 + th4 + th5) + 10*th1d*th4d*sin(th1 + th2 + th3 + th4 + th5) + 10*th2d*th3d*sin(th1 + th2 + th3 + th4 + th5) + 10*th1d*th5d*sin(th1 + th2 + th3 + th4 + th5) + 10*th2d*th4d*sin(th1 + th2 + th3 + th4 + th5) + 10*th2d*th5d*sin(th1 + th2 + th3 + th4 + th5) + 10*th3d*th4d*sin(th1 + th2 + th3 + th4 + th5) + 10*th3d*th5d*sin(th1 + th2 + th3 + th4 + th5) + 10*th4d*th5d*sin(th1 + th2 + th3 + th4 + th5) + 10*th1d*th2d*sin(th1 + th2 + th3) + 10*th1d*th3d*sin(th1 + th2 + th3) + 10*th2d*th3d*sin(th1 + th2 + th3) + 10*th1d*th2d*sin(th1 + th2 + th3 + th4) + 10*th1d*th3d*sin(th1 + th2 + th3 + th4) + 10*th1d*th4d*sin(th1 + th2 + th3 + th4) + 10*th2d*th3d*sin(th1 + th2 + th3 + th4) + 10*th2d*th4d*sin(th1 + th2 + th3 + th4) + 10*th3d*th4d*sin(th1 + th2 + th3 + th4); - 5*th1d^2*cos(th1) - 5*th1d^2*cos(th1 + th2 + th3 + th4 + th5) - 5*th2d^2*cos(th1 + th2 + th3 + th4 + th5) - 5*th3d^2*cos(th1 + th2 + th3 + th4 + th5) - 5*th4d^2*cos(th1 + th2 + th3 + th4 + th5) - 5*th5d^2*cos(th1 + th2 + th3 + th4 + th5) - 5*th1d^2*cos(th1 + th2 + th3) - 5*th2d^2*cos(th1 + th2 + th3) - 5*th3d^2*cos(th1 + th2 + th3) - 5*th1d^2*cos(th1 + th2 + th3 + th4) - 5*th2d^2*cos(th1 + th2 + th3 + th4) - 5*th3d^2*cos(th1 + th2 + th3 + th4) - 5*th4d^2*cos(th1 + th2 + th3 + th4) - 5*th1d^2*cos(th1 + th2) - 5*th2d^2*cos(th1 + th2) - 10*th1d*th2d*cos(th1 + th2 + th3 + th4 + th5) - 10*th1d*th3d*cos(th1 + th2 + th3 + th4 + th5) - 10*th1d*th4d*cos(th1 + th2 + th3 + th4 + th5) - 10*th2d*th3d*cos(th1 + th2 + th3 + th4 + th5) - 10*th1d*th5d*cos(th1 + th2 + th3 + th4 + th5) - 10*th2d*th4d*cos(th1 + th2 + th3 + th4 + th5) - 10*th2d*th5d*cos(th1 + th2 + th3 + th4 + th5) - 10*th3d*th4d*cos(th1 + th2 + th3 + th4 + th5) - 10*th3d*th5d*cos(th1 + th2 + th3 + th4 + th5) - 10*th4d*th5d*cos(th1 + th2 + th3 + th4 + th5) - 10*th1d*th2d*cos(th1 + th2 + th3) - 10*th1d*th3d*cos(th1 + th2 + th3) - 10*th2d*th3d*cos(th1 + th2 + th3) - 10*th1d*th2d*cos(th1 + th2 + th3 + th4) - 10*th1d*th3d*cos(th1 + th2 + th3 + th4) - 10*th1d*th4d*cos(th1 + th2 + th3 + th4) - 10*th2d*th3d*cos(th1 + th2 + th3 + th4) - 10*th2d*th4d*cos(th1 + th2 + th3 + th4) - 10*th3d*th4d*cos(th1 + th2 + th3 + th4) - 10*th1d*th2d*cos(th1 + th2)];
dyn = U\W;
qd = [th1d; th2d; th3d; th4d; th5d; dyn(1:5)];
end