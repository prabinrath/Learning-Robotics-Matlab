function E = chain_pendulum_energy(q)
th1 = q(1); th2 = q(2); th3 = q(3); th4 = q(4); th5 = q(5);
th1d = q(6); th2d = q(7); th3d = q(8); th4d = q(9); th5d = q(10);
E = (175*th1d^2*cos(th2))/4 - (981*cos(th1 + th2 + th3))/16 - (2943*cos(th1 + th2 + th3 + th4))/80 - (6867*cos(th1 + th2))/80 - (8829*cos(th1))/80 - (981*cos(th1 + th2 + th3 + th4 + th5))/80 + (125*th1d^2*cos(th3))/4 + (75*th1d^2*cos(th4))/4 + (125*th2d^2*cos(th3))/4 + (25*th1d^2*cos(th5))/4 + (75*th2d^2*cos(th4))/4 + (25*th2d^2*cos(th5))/4 + (75*th3d^2*cos(th4))/4 + (25*th3d^2*cos(th5))/4 + (25*th4d^2*cos(th5))/4 + (275*th1d*th2d)/3 + 50*th1d*th3d + (125*th1d*th4d)/6 + 50*th2d*th3d + (25*th1d*th5d)/6 + (125*th2d*th4d)/6 + (25*th2d*th5d)/6 + (125*th3d*th4d)/6 + (25*th3d*th5d)/6 + (25*th4d*th5d)/6 + (75*th1d^2*cos(th2 + th3 + th4))/4 + (25*th1d^2*cos(th3 + th4 + th5))/4 + (25*th2d^2*cos(th3 + th4 + th5))/4 + (25*th1d^2*cos(th2 + th3 + th4 + th5))/4 + (875*th1d^2)/12 + (275*th2d^2)/6 + 25*th3d^2 + (125*th4d^2)/12 + (25*th5d^2)/12 + (125*th1d^2*cos(th2 + th3))/4 + (75*th1d^2*cos(th3 + th4))/4 + (75*th2d^2*cos(th3 + th4))/4 + (25*th1d^2*cos(th4 + th5))/4 + (25*th2d^2*cos(th4 + th5))/4 + (25*th3d^2*cos(th4 + th5))/4 + (175*th1d*th2d*cos(th2))/4 + (125*th1d*th2d*cos(th3))/2 + (75*th1d*th2d*cos(th4))/2 + (125*th1d*th3d*cos(th3))/4 + (25*th1d*th2d*cos(th5))/2 + (75*th1d*th3d*cos(th4))/2 + (125*th2d*th3d*cos(th3))/4 + (25*th1d*th3d*cos(th5))/2 + (75*th1d*th4d*cos(th4))/4 + (75*th2d*th3d*cos(th4))/2 + (25*th1d*th4d*cos(th5))/2 + (25*th2d*th3d*cos(th5))/2 + (75*th2d*th4d*cos(th4))/4 + (25*th1d*th5d*cos(th5))/4 + (25*th2d*th4d*cos(th5))/2 + (75*th3d*th4d*cos(th4))/4 + (25*th2d*th5d*cos(th5))/4 + (25*th3d*th4d*cos(th5))/2 + (25*th3d*th5d*cos(th5))/4 + (25*th4d*th5d*cos(th5))/4 + (75*th1d*th2d*cos(th2 + th3 + th4))/4 + (75*th1d*th3d*cos(th2 + th3 + th4))/4 + (75*th1d*th4d*cos(th2 + th3 + th4))/4 + (25*th1d*th2d*cos(th3 + th4 + th5))/2 + (25*th1d*th3d*cos(th3 + th4 + th5))/4 + (25*th1d*th4d*cos(th3 + th4 + th5))/4 + (25*th2d*th3d*cos(th3 + th4 + th5))/4 + (25*th1d*th5d*cos(th3 + th4 + th5))/4 + (25*th2d*th4d*cos(th3 + th4 + th5))/4 + (25*th2d*th5d*cos(th3 + th4 + th5))/4 + (25*th1d*th2d*cos(th2 + th3 + th4 + th5))/4 + (25*th1d*th3d*cos(th2 + th3 + th4 + th5))/4 + (25*th1d*th4d*cos(th2 + th3 + th4 + th5))/4 + (25*th1d*th5d*cos(th2 + th3 + th4 + th5))/4 + (125*th1d*th2d*cos(th2 + th3))/4 + (125*th1d*th3d*cos(th2 + th3))/4 + (75*th1d*th2d*cos(th3 + th4))/2 + (75*th1d*th3d*cos(th3 + th4))/4 + (25*th1d*th2d*cos(th4 + th5))/2 + (75*th1d*th4d*cos(th3 + th4))/4 + (75*th2d*th3d*cos(th3 + th4))/4 + (25*th1d*th3d*cos(th4 + th5))/2 + (75*th2d*th4d*cos(th3 + th4))/4 + (25*th1d*th4d*cos(th4 + th5))/4 + (25*th2d*th3d*cos(th4 + th5))/2 + (25*th1d*th5d*cos(th4 + th5))/4 + (25*th2d*th4d*cos(th4 + th5))/4 + (25*th2d*th5d*cos(th4 + th5))/4 + (25*th3d*th4d*cos(th4 + th5))/4 + (25*th3d*th5d*cos(th4 + th5))/4;
end