function qdd = double_pendulum_dynamics(th1,th2,th1d,th2d,tau1,tau2)
    qdd = [th1d; th2d; (3*(80*tau1 - 80*tau2 - 2943*sin(th1) - 2943*cos(th2)^2*sin(th1)^3 - 8829*sin(th1)^3*sin(th2)^2 + 240*tau1*cos(th1)^2*cos(th2)^2 - 240*tau2*cos(th1)^2*cos(th2)^2 + 240*tau1*cos(th1)^2*sin(th2)^2 + 240*tau1*cos(th2)^2*sin(th1)^2 - 240*tau2*cos(th1)^2*sin(th2)^2 - 240*tau2*cos(th2)^2*sin(th1)^2 + 500*th1d^2*cos(th1)^2*sin(th2) + 500*th2d^2*cos(th1)^2*sin(th2) + 5886*cos(th1)^3*cos(th2)*sin(th2) + 240*tau1*sin(th1)^2*sin(th2)^2 - 240*tau2*sin(th1)^2*sin(th2)^2 + 500*th1d^2*sin(th1)^2*sin(th2) + 500*th2d^2*sin(th1)^2*sin(th2) + 1500*th1d^2*cos(th1)^4*sin(th2)^3 + 1500*th2d^2*cos(th1)^4*sin(th2)^3 - 2943*cos(th1)^2*cos(th2)^2*sin(th1) + 1500*th1d^2*sin(th1)^4*sin(th2)^3 + 1500*th2d^2*sin(th1)^4*sin(th2)^3 - 8829*cos(th1)^2*sin(th1)*sin(th2)^2 - 480*tau2*cos(th1)^2*cos(th2) - 480*tau2*cos(th2)*sin(th1)^2 + 3000*th1d^2*cos(th1)^4*cos(th2)*sin(th2) + 3000*th1d^2*cos(th2)*sin(th1)^4*sin(th2) + 5886*cos(th1)*cos(th2)*sin(th1)^2*sin(th2) + 1000*th1d*th2d*cos(th1)^2*sin(th2) + 1000*th1d*th2d*sin(th1)^2*sin(th2) + 1500*th1d^2*cos(th1)^4*cos(th2)^2*sin(th2) + 1500*th2d^2*cos(th1)^4*cos(th2)^2*sin(th2) + 1500*th1d^2*cos(th2)^2*sin(th1)^4*sin(th2) + 1500*th2d^2*cos(th2)^2*sin(th1)^4*sin(th2) + 3000*th1d*th2d*cos(th1)^4*sin(th2)^3 + 3000*th1d*th2d*sin(th1)^4*sin(th2)^3 + 3000*th1d^2*cos(th1)^2*sin(th1)^2*sin(th2)^3 + 3000*th2d^2*cos(th1)^2*sin(th1)^2*sin(th2)^3 + 6000*th1d*th2d*cos(th1)^2*sin(th1)^2*sin(th2)^3 + 6000*th1d^2*cos(th1)^2*cos(th2)*sin(th1)^2*sin(th2) + 3000*th1d*th2d*cos(th1)^4*cos(th2)^2*sin(th2) + 3000*th1d*th2d*cos(th2)^2*sin(th1)^4*sin(th2) + 3000*th1d^2*cos(th1)^2*cos(th2)^2*sin(th1)^2*sin(th2) + 3000*th2d^2*cos(th1)^2*cos(th2)^2*sin(th1)^2*sin(th2) + 6000*th1d*th2d*cos(th1)^2*cos(th2)^2*sin(th1)^2*sin(th2)))/(250*(15*cos(th1)^2 + 15*sin(th1)^2 + 3*cos(th1)^2*cos(th2)^2 + 9*cos(th1)^4*cos(th2)^2 + 3*cos(th1)^2*sin(th2)^2 + 3*cos(th2)^2*sin(th1)^2 + 9*cos(th2)^2*sin(th1)^4 + 45*cos(th1)^4*sin(th2)^2 + 3*sin(th1)^2*sin(th2)^2 + 45*sin(th1)^4*sin(th2)^2 + 18*cos(th1)^2*cos(th2)^2*sin(th1)^2 + 90*cos(th1)^2*sin(th1)^2*sin(th2)^2 + 1));-(3*(80*tau1 - 160*tau2 - 2943*sin(th1) - 1200*tau2*cos(th1)^2 - 1200*tau2*sin(th1)^2 + 981*cos(th1)*sin(th2) + 981*cos(th2)*sin(th1) - 2943*cos(th2)*sin(th1)^3 + 14715*cos(th1)^3*sin(th2) - 2943*cos(th2)^2*sin(th1)^3 - 8829*sin(th1)^3*sin(th2)^2 + 240*tau1*cos(th1)^2*cos(th2)^2 - 240*tau2*cos(th1)^2*cos(th2)^2 + 240*tau1*cos(th1)^2*sin(th2)^2 + 240*tau1*cos(th2)^2*sin(th1)^2 - 240*tau2*cos(th1)^2*sin(th2)^2 - 240*tau2*cos(th2)^2*sin(th1)^2 + 1000*th1d^2*cos(th1)^2*sin(th2) + 500*th2d^2*cos(th1)^2*sin(th2) + 7500*th1d^2*cos(th1)^4*sin(th2) - 2943*cos(th1)^2*cos(th2)*sin(th1) + 5886*cos(th1)^3*cos(th2)*sin(th2) + 240*tau1*sin(th1)^2*sin(th2)^2 - 240*tau2*sin(th1)^2*sin(th2)^2 + 1000*th1d^2*sin(th1)^2*sin(th2) + 500*th2d^2*sin(th1)^2*sin(th2) + 7500*th1d^2*sin(th1)^4*sin(th2) + 14715*cos(th1)*sin(th1)^2*sin(th2) + 1500*th1d^2*cos(th1)^4*sin(th2)^3 + 1500*th2d^2*cos(th1)^4*sin(th2)^3 - 2943*cos(th1)^2*cos(th2)^2*sin(th1) + 1500*th1d^2*sin(th1)^4*sin(th2)^3 + 1500*th2d^2*sin(th1)^4*sin(th2)^3 - 8829*cos(th1)^2*sin(th1)*sin(th2)^2 + 480*tau1*cos(th1)^2*cos(th2) - 960*tau2*cos(th1)^2*cos(th2) + 480*tau1*cos(th2)*sin(th1)^2 - 960*tau2*cos(th2)*sin(th1)^2 + 6000*th1d^2*cos(th1)^4*cos(th2)*sin(th2) + 3000*th2d^2*cos(th1)^4*cos(th2)*sin(th2) + 6000*th1d^2*cos(th2)*sin(th1)^4*sin(th2) + 3000*th2d^2*cos(th2)*sin(th1)^4*sin(th2) + 5886*cos(th1)*cos(th2)*sin(th1)^2*sin(th2) + 1000*th1d*th2d*cos(th1)^2*sin(th2) + 1000*th1d*th2d*sin(th1)^2*sin(th2) + 1500*th1d^2*cos(th1)^4*cos(th2)^2*sin(th2) + 1500*th2d^2*cos(th1)^4*cos(th2)^2*sin(th2) + 15000*th1d^2*cos(th1)^2*sin(th1)^2*sin(th2) + 1500*th1d^2*cos(th2)^2*sin(th1)^4*sin(th2) + 1500*th2d^2*cos(th2)^2*sin(th1)^4*sin(th2) + 3000*th1d*th2d*cos(th1)^4*sin(th2)^3 + 3000*th1d*th2d*sin(th1)^4*sin(th2)^3 + 3000*th1d^2*cos(th1)^2*sin(th1)^2*sin(th2)^3 + 3000*th2d^2*cos(th1)^2*sin(th1)^2*sin(th2)^3 + 6000*th1d*th2d*cos(th1)^2*sin(th1)^2*sin(th2)^3 + 6000*th1d*th2d*cos(th1)^4*cos(th2)*sin(th2) + 6000*th1d*th2d*cos(th2)*sin(th1)^4*sin(th2) + 12000*th1d^2*cos(th1)^2*cos(th2)*sin(th1)^2*sin(th2) + 6000*th2d^2*cos(th1)^2*cos(th2)*sin(th1)^2*sin(th2) + 3000*th1d*th2d*cos(th1)^4*cos(th2)^2*sin(th2) + 3000*th1d*th2d*cos(th2)^2*sin(th1)^4*sin(th2) + 3000*th1d^2*cos(th1)^2*cos(th2)^2*sin(th1)^2*sin(th2) + 3000*th2d^2*cos(th1)^2*cos(th2)^2*sin(th1)^2*sin(th2) + 12000*th1d*th2d*cos(th1)^2*cos(th2)*sin(th1)^2*sin(th2) + 6000*th1d*th2d*cos(th1)^2*cos(th2)^2*sin(th1)^2*sin(th2)))/(250*(15*cos(th1)^2 + 15*sin(th1)^2 + 3*cos(th1)^2*cos(th2)^2 + 9*cos(th1)^4*cos(th2)^2 + 3*cos(th1)^2*sin(th2)^2 + 3*cos(th2)^2*sin(th1)^2 + 9*cos(th2)^2*sin(th1)^4 + 45*cos(th1)^4*sin(th2)^2 + 3*sin(th1)^2*sin(th2)^2 + 45*sin(th1)^4*sin(th2)^2 + 18*cos(th1)^2*cos(th2)^2*sin(th1)^2 + 90*cos(th1)^2*sin(th1)^2*sin(th2)^2 + 1))];
end

